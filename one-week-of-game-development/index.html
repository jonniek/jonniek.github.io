<!DOCTYPE html><html lang="en-us" q:render="static-ssr" q:container="paused" q:version="1.0.0" q:base="/build/" q:locale><!--qv q:id=0 q:key=3scc:pY_0--><!--qv q:id=1 q:key=TxCF:35_3--><!--qv q:s q:sref=1 q:key=--><head q:head><meta charSet="utf-8" q:head><!--qv q:id=2 q:key=zrbr:35_0--><!--qv q:key=OA_0--><title q:head>One week game development project</title><link rel="canonical" href="https://jonniek.github.io/one-week-of-game-development/" q:id="3" q:head><meta name="viewport" content="width=device-width, initial-scale=1.0" q:head><link id="favicon" rel="icon" type="image/svg+xml" href="/favicon.svg?v=7" q:head><meta property="og:site_name" content="Jonniek" q:head><meta property="og:title" content="One week game development project" q:key="0" q:head><meta property="og:description" content="Creating a game in Rust and Bevy with no game dev experience!" q:key="1" q:head><meta property="description" content="Creating a game in Rust and Bevy with no game dev experience!" q:key="2" q:head><meta property="og:image" content="/images/slimegame/slimegame_gameplay.png" q:key="3" q:head><script q:head>
        const cssPreferenceTheme = window.matchMedia(
          "(prefers-color-scheme: dark)"
        ).matches
          ? "dark"
          : "light";

        const theme = localStorage.getItem("theme") || cssPreferenceTheme;
        document.documentElement.setAttribute('data-theme', theme);

        let hue = localStorage.getItem("brand-color-hue");
        if (hue === null) {
          hue = theme === "dark" ? "30" : "195";
        }
        const hsl = "hsl(" + hue + ", 67%, 57%)";
        document.documentElement.style.setProperty("--brand-color", hsl);
        document.documentElement.style.setProperty("--brand-color-hue", String(hue));
        const svg = '<svg height="100" width="100" xmlns="http://www.w3.org/2000/svg"><style>circle{transition:stroke 2s ease-in}</style><circle cx="50" cy="50" r="36" stroke="' + hsl + '" stroke-width="25" fill="transparent" /></svg>';
        const faviconElement = document.querySelector("#favicon");
        if (faviconElement) {
          faviconElement.setAttribute("href", "data:image/svg+xml;utf8," + svg);
        }
      </script><!--/qv--><!--/qv--><style data-src="/build/q-3de7e6c9.css">:root{--brand-color: #47b6db;--primary-text-color: #333;--secondary-text-color: #727272;--primary-background-color: #fefefe;--secondary-background-color: #f6f8fa;--link-text-color: #07a;--box-shadow: rgba(50, 50, 93, .25) 0px 2px 5px -1px, rgba(0, 0, 0, .3) 0px 1px 3px -1px}@media (prefers-color-scheme: dark){:root{--brand-color: hsl(27, 67%, 57%);--primary-text-color: #ece8de;--secondary-text-color: #a9ab97;--primary-background-color: #1c2024;--secondary-background-color: #31383e;--link-text-color: rgb(64, 181, 231);--box-shadow: none}}[data-theme=dark]{--brand-color: hsl(27, 67%, 57%);--primary-text-color: #ece8de;--secondary-text-color: #a9ab97;--primary-background-color: #1c2024;--secondary-background-color: #31383e;--link-text-color: rgb(64, 181, 231);--box-shadow: none}[data-theme=light]{--brand-color: #47b6db;--primary-text-color: #333;--secondary-text-color: #727272;--primary-background-color: #fefefe;--secondary-background-color: #f6f8fa;--link-text-color: #07a;--box-shadow: rgba(50, 50, 93, .25) 0px 2px 5px -1px, rgba(0, 0, 0, .3) 0px 1px 3px -1px}html{scroll-behavior:smooth;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif;font-size:16px;word-spacing:1px;color:var(--primary-text-color);background-color:var(--primary-background-color);-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;box-sizing:border-box;margin:0;padding:0;line-height:1.5;display:flex;justify-content:center;transition:color .15s ease-in-out;transition:background-color .15s ease-in-out}body{margin:0;padding:0}blockquote{background:var(--secondary-background-color);border-left:5px solid var(--brand-color);padding:5px 10px;border-top-right-radius:5px;border-bottom-right-radius:5px;margin:10px 0}code,pre,.inline-code{font-family:SF Mono,Monaco,Inconsolata,Fira Mono,Droid Sans Mono,Source Code Pro,monospace}pre{padding:16px;border-radius:6px;background:var(--secondary-background-color);overflow-x:scroll}.inline-code{background:var(--secondary-background-color);padding:1px 3px;border-radius:2px;font-size:83%}article{width:43em;max-width:90vw;padding:6px 0 100px}*,*:before,*:after{box-sizing:border-box;margin:0}p{margin:1em 0}article,aside,footer,header,nav,section{display:block}h1{font-size:2.5em;margin:.67em 0;text-align:center;color:var(--primary-text-color)}hr{box-sizing:content-box;height:0;overflow:visible}a{background-color:transparent;-webkit-text-decoration-skip:objects}b,strong{font-weight:inherit}b,strong{font-weight:bolder}code,kbd,samp{font-family:SF Mono,Monaco,Inconsolata,Fira Mono,Droid Sans Mono,Source Code Pro,monospace;font-size:1em;white-space:pre}small{font-size:80%}sub{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}audio,video{display:inline-block}audio:not([controls]){display:none;height:0}img,video{display:block;border-style:none;max-width:100%;height:auto;margin:5px auto}svg:not(:root){overflow:hidden}canvas{display:inline-block}[hidden]{display:none}a,.text-button{color:var(--link-text-color);text-decoration:none;transition:all .2s ease-in-out;cursor:pointer}a:hover,.text-button:hover{opacity:1;filter:brightness(110%) saturate(110%)}a.novisited:visited{color:var(--link-text-color)}.center{text-align:center}.loader{display:inline-block;height:25px;width:25px;border-radius:50%;border:3px solid var(--brand-color);border-top-color:transparent;animation:loader .6s linear infinite}@keyframes loader{to{transform:rotate(360deg)}}
</style><style q:style="lcydw1-0" hidden>:root{view-transition-name:none}</style></head><body lang="en" on-window:load="q-54615ccf.js#s_AuSWPD4QjRQ[0]" q:id="4"><!--qv q:id=5 q:key=AKet:35_1--><!--qv q:id=6 q:key=VkLN:k8_0--><div style="display:flex" q:key="XF_2"><!--qv q:sstyle=⭐️nowf1j-0 q:id=7 q:key=fkz5:XF_0--><style q:style="nowf1j-0" hidden>.theme-toggle-container.⭐️nowf1j-0{cursor:pointer;height:30px;margin:8px 16px 8px auto;position:absolute;right:0}.theme-toggle-container.⭐️nowf1j-0 circle.⭐️nowf1j-0{transition:stroke .2s ease-in-out}
</style><div class="⭐️nowf1j-0 theme-toggle-container" on:click="q-0a1e4242.js#s_01rnlL1x0VM[0]" q:key="JN_0" q:id="8"><svg height="100%" width="100%" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg" class="⭐️nowf1j-0"><circle cx="50" cy="50" r="36" stroke="var(--brand-color)" stroke-width="25" fill="transparent" class="⭐️nowf1j-0"></circle></svg></div><!--/qv--><!--qv q:s q:sref=6 q:key=--><!--qv q:id=9 q:key=1DsT:k8_0--><article q:key="XF_15"><div><a href="/">Home</a></div><h1>One week game development project</h1><p>January 4, 2023</p><!--qv q:sstyle=⭐️pubbq6-0 q:id=a q:key=BiHb:XF_0--><style q:style="pubbq6-0" hidden>.image-container.⭐️pubbq6-0{position:relative;width:100%;height:0;overflow:hidden;border-radius:5px;box-shadow:var(--box-shadow)}.image-placeholder.⭐️pubbq6-0{position:absolute;background:linear-gradient(to top,var(--primary-background-color),var(--secondary-background-color));width:100%;height:100%;left:0;top:0;box-sizing:content-box;margin:0}img.⭐️pubbq6-0{position:absolute;width:100%;height:100%;left:0;top:0;box-sizing:content-box;margin:0}
</style><div style="padding-bottom:37.66233766233766%" class="⭐️pubbq6-0 image-container" q:key="Qj_0" q:id="b"><div style="background:#b3997f" class="⭐️pubbq6-0 image-placeholder" q:id="c"></div><img alt src="/images/slimegame/slimegame_gameplay.png" class="⭐️pubbq6-0" q:id="d"></div><!--/qv--><p><a href="#play"><small>TLDR: if you just want to play the game click here</small></a></p><h2>Let's make a game. But why?</h2><p>I'm on work assignment in Japan and they have quite many public holidays around new years. Most places are closed during this time so instead of traveling around I decided to challenge myself with a solo game jam. I've always been somewhat interested in game development, but never quite had the time or motivation to properly learn it. I decided to make a game in seven days from scratch. As a software developer with no game development experience I wasn't quite sure what I was getting into.</p><h2>Day 1</h2><p>The first day was mostly spent on deciding which game engine to use. After some comparisons and research I decided to give Bevy a try. Bevy is an ECS based game engine for Rust. I really like the premise of the engine even though it's quite barebones.</p><p>The first day I only implemented some basic player movement.</p><!--qv q:sstyle=⭐️20zyf1-0 q:id=e q:key=yx4i:XF_1--><style q:style="20zyf1-0" hidden>.video-container.⭐️20zyf1-0{position:relative;width:100%;height:0;overflow:hidden;border-radius:5px;box-shadow:var(--box-shadow);margin:1rem 0}.video-placeholder.⭐️20zyf1-0{position:absolute;background:linear-gradient(to top,var(--primary-background-color),var(--secondary-background-color));width:100%;height:100%;left:0;top:0;box-sizing:content-box;margin:0}video.⭐️20zyf1-0{position:absolute;width:100%;height:100%;left:0;top:0;box-sizing:content-box;margin:0}
</style><div style="padding-bottom:56.25%" class="⭐️20zyf1-0 video-container" q:key="Aa_0" q:id="f"><div style="background:#787878" class="⭐️20zyf1-0 video-placeholder" q:id="g"></div><video src="/images/slimegame/day_01_input.mp4" controls="" class="⭐️20zyf1-0" q:id="h"></video></div><!--/qv--><h2>Day 2</h2><p>I started experimenting with physics. I chose to use Rapier as a physics engine as it seemed the most popular. It was really confusing but I got something working after a lot of trial and error.</p><!--qv q:sstyle=⭐️20zyf1-0 q:id=i q:key=yx4i:XF_2--><div style="padding-bottom:56.25%" class="⭐️20zyf1-0 video-container" q:key="Aa_0" q:id="j"><div style="background:#787878" class="⭐️20zyf1-0 video-placeholder" q:id="k"></div><video src="/images/slimegame/day_02_physics.mp4" controls="" class="⭐️20zyf1-0" q:id="l"></video></div><!--/qv--><p>What you are seeing above is not actually fully Rapier physics because I was doing it wrong. I was manually reversing and damping the velocity on collision. This kind of broke down once you got into close contact like sliding. What later helped me understand and setup Rapier correctly was <a rel="noopener" target="_blank" href="https://www.youtube.com/watch?v=fFm1IxuPQxA">this presentation</a> by Nathan Stocks. It simply setup some components for the entities that handle all the collisions and dampening automatically. I wish the Rapier Bevy plugin getting started documentation was a bit more like this video.</p><p>On the second day I also did some Tilemap experimentation with LDtk. With a plugin I got LDtk levels imported to the game quite easily. However, after importing it I kind of got stuck not being able to continue development. I think this was due to a lack of understanding of how the plugin and LDtk worked. I decided to ditch the LDtk approach to make progress in the actual game.</p><!--qv q:sstyle=⭐️20zyf1-0 q:id=m q:key=yx4i:XF_3--><div style="padding-bottom:56.25%" class="⭐️20zyf1-0 video-container" q:key="Aa_0" q:id="n"><div style="background:#787878" class="⭐️20zyf1-0 video-placeholder" q:id="o"></div><video src="/images/slimegame/day_02_map.mp4" controls="" class="⭐️20zyf1-0" q:id="p"></video></div><!--/qv--><h2>Day 3</h2><p>On the third day I created a basic game loop. The purpose of the game is to eat all red slimes. When you eat a slime you grow in size, which will help you finish eating them all.</p><!--qv q:sstyle=⭐️20zyf1-0 q:id=q q:key=yx4i:XF_4--><div style="padding-bottom:56.25%" class="⭐️20zyf1-0 video-container" q:key="Aa_0" q:id="r"><div style="background:#787878" class="⭐️20zyf1-0 video-placeholder" q:id="s"></div><video src="/images/slimegame/day_03_game.mp4" controls="" class="⭐️20zyf1-0" q:id="t"></video></div><!--/qv--><h2>Day 4</h2><p>Now that there was a "complete" game, I decided to add a menu and game over screen. It's quite verbose to declare plugins for the game states. However, the UI components themselves were quite nice with CSS flexbox like styling. I wanted to add some settings menu, but I didn't really have any settings to change. So in order to save more time to making the game better I left it out of scope.</p><!--qv q:sstyle=⭐️20zyf1-0 q:id=u q:key=yx4i:XF_5--><div style="padding-bottom:56.25%" class="⭐️20zyf1-0 video-container" q:key="Aa_0" q:id="v"><div style="background:#787878" class="⭐️20zyf1-0 video-placeholder" q:id="w"></div><video src="/images/slimegame/day_04_menu.mp4" controls="" class="⭐️20zyf1-0" q:id="x"></video></div><!--/qv--><h2>Day 5</h2><p>Scaling the player made it look very bad and pixelated so I changed the gameplay a bit. Instead of running into red slimes, from now on one should avoid them. I added some weapons to help deal with the evergrowing slime population.</p><!--qv q:sstyle=⭐️20zyf1-0 q:id=y q:key=yx4i:XF_6--><div style="padding-bottom:56.25%" class="⭐️20zyf1-0 video-container" q:key="Aa_0" q:id="z"><div style="background:#787878" class="⭐️20zyf1-0 video-placeholder" q:id="10"></div><video src="/images/slimegame/day_05_mechanics.mp4" controls="" class="⭐️20zyf1-0" q:id="11"></video></div><!--/qv--><h2>Day 6</h2><p>Adding more features.</p><ul><li>Local coop</li><li>Health for enemies</li><li>New weapon for player 2</li><li>Stronger enemy slimes that move towards player</li><li>I couldn't figure out how to make an image as an infinite tiled background. So I just added a colored background with some lines drawn with Lyon.</li></ul><!--qv q:sstyle=⭐️20zyf1-0 q:id=12 q:key=yx4i:XF_7--><div style="padding-bottom:56.25%" class="⭐️20zyf1-0 video-container" q:key="Aa_0" q:id="13"><div style="background:#b2987f" class="⭐️20zyf1-0 video-placeholder" q:id="14"></div><video src="/images/slimegame/day_06_polish.mp4" controls="" class="⭐️20zyf1-0" q:id="15"></video></div><!--/qv--><h2>Day 7</h2><p>Final polish.</p><ul><li>Update all assets to be original. Instead of zooming camera I just made assets bigger.</li><li>Red zone that kills player. I wanted to make it a circle but I didn't have time to figure out how to punch a hole in a square in Lyon.</li><li>Indicator when weapon is ready to use. This was surprisingly easy with child entities and sprite visibility toggling.</li><li>Remove redundant screens. The game over screen was almost the same as start screen and the splash screen just looked like some loading issue.</li></ul><!--qv q:sstyle=⭐️20zyf1-0 q:id=16 q:key=yx4i:XF_8--><div style="padding-bottom:56.25%" class="⭐️20zyf1-0 video-container" q:key="Aa_0" q:id="17"><div style="background:#b2987f" class="⭐️20zyf1-0 video-placeholder" q:id="18"></div><video src="/images/slimegame/day_07_polish.mp4" controls="" class="⭐️20zyf1-0" q:id="19"></video></div><!--/qv--><h2>Building to web assembly</h2><p>To my surprise I did not need to change anything in my source code in order to build the game in wasm. Adding it to my website was trivial. Really nice experience overall.</p><!--qv q:id=1a q:key=gQCP:XF_9--><style q:style="qcam0r-0" hidden>pre code.hljs{display:block;overflow-x:auto;padding:1em}code.hljs{padding:3px 5px}.hljs{color:#24292e;background:#fff}.hljs-doctag,.hljs-keyword,.hljs-meta .hljs-keyword,.hljs-template-tag,.hljs-template-variable,.hljs-type,.hljs-variable.language_{color:#d73a49}.hljs-title,.hljs-title.class_,.hljs-title.class_.inherited__,.hljs-title.function_{color:#6f42c1}.hljs-attr,.hljs-attribute,.hljs-literal,.hljs-meta,.hljs-number,.hljs-operator,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-id,.hljs-variable{color:#005cc5}.hljs-meta .hljs-string,.hljs-regexp,.hljs-string{color:#032f62}.hljs-built_in,.hljs-symbol{color:#e36209}.hljs-code,.hljs-comment,.hljs-formula{color:#6a737d}.hljs-name,.hljs-quote,.hljs-selector-pseudo,.hljs-selector-tag{color:#22863a}.hljs-subst{color:#24292e}.hljs-section{color:#005cc5;font-weight:700}.hljs-bullet{color:#735c0f}.hljs-emphasis{color:#24292e;font-style:italic}.hljs-strong{color:#24292e;font-weight:700}.hljs-addition{color:#22863a;background-color:#f0fff4}.hljs-deletion{color:#b31d28;background-color:#ffeef0}@media (prefers-color-scheme: dark){.hljs{color:#c9d1d9;background:#0d1117}.hljs-doctag,.hljs-keyword,.hljs-meta .hljs-keyword,.hljs-template-tag,.hljs-template-variable,.hljs-type,.hljs-variable.language_{color:#ff7b72}.hljs-title,.hljs-title.class_,.hljs-title.class_.inherited__,.hljs-title.function_{color:#d2a8ff}.hljs-attr,.hljs-attribute,.hljs-literal,.hljs-meta,.hljs-number,.hljs-operator,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-id,.hljs-variable{color:#79c0ff}.hljs-meta .hljs-string,.hljs-regexp,.hljs-string{color:#a5d6ff}.hljs-built_in,.hljs-symbol{color:#ffa657}.hljs-code,.hljs-comment,.hljs-formula{color:#8b949e}.hljs-name,.hljs-quote,.hljs-selector-pseudo,.hljs-selector-tag{color:#7ee787}.hljs-subst{color:#c9d1d9}.hljs-section{color:#1f6feb;font-weight:700}.hljs-bullet{color:#f2cc60}.hljs-emphasis{color:#c9d1d9;font-style:italic}.hljs-strong{color:#c9d1d9;font-weight:700}.hljs-addition{color:#aff5b4;background-color:#033a16}.hljs-deletion{color:#ffdcd7;background-color:#67060c}}[data-theme=dark] .hljs{color:#c9d1d9;background:#0d1117}[data-theme=dark] .hljs-doctag,[data-theme=dark] .hljs-keyword,[data-theme=dark] .hljs-meta [data-theme=dark] .hljs-keyword,[data-theme=dark] .hljs-template-tag,[data-theme=dark] .hljs-template-variable,[data-theme=dark] .hljs-type,[data-theme=dark] .hljs-variable[data-theme=dark] .language_{color:#ff7b72}[data-theme=dark] .hljs-title,[data-theme=dark] .hljs-title[data-theme=dark] .class_,[data-theme=dark] .hljs-title[data-theme=dark] .class_[data-theme=dark] .inherited__,[data-theme=dark] .hljs-title[data-theme=dark] .function_{color:#d2a8ff}[data-theme=dark] .hljs-attr,[data-theme=dark] .hljs-attribute,[data-theme=dark] .hljs-literal,[data-theme=dark] .hljs-meta,[data-theme=dark] .hljs-number,[data-theme=dark] .hljs-operator,[data-theme=dark] .hljs-selector-attr,[data-theme=dark] .hljs-selector-class,[data-theme=dark] .hljs-selector-id,[data-theme=dark] .hljs-variable{color:#79c0ff}[data-theme=dark] .hljs-meta [data-theme=dark] .hljs-string,[data-theme=dark] .hljs-regexp,[data-theme=dark] .hljs-string{color:#a5d6ff}[data-theme=dark] .hljs-built_in,[data-theme=dark] .hljs-symbol{color:#ffa657}[data-theme=dark] .hljs-code,[data-theme=dark] .hljs-comment,[data-theme=dark] .hljs-formula{color:#8b949e}[data-theme=dark] .hljs-name,[data-theme=dark] .hljs-quote,[data-theme=dark] .hljs-selector-pseudo,[data-theme=dark] .hljs-selector-tag{color:#7ee787}[data-theme=dark] .hljs-subst{color:#c9d1d9}[data-theme=dark] .hljs-section{color:#1f6feb;font-weight:700}[data-theme=dark] .hljs-bullet{color:#f2cc60}[data-theme=dark] .hljs-emphasis{color:#c9d1d9;font-style:italic}[data-theme=dark] .hljs-strong{color:#c9d1d9;font-weight:700}[data-theme=dark] .hljs-addition{color:#aff5b4;background-color:#033a16}[data-theme=dark] .hljs-deletion{color:#ffdcd7;background-color:#67060c}[data-theme=light] .hljs{color:#24292e;background:#fff}[data-theme=light] .hljs-doctag,[data-theme=light] .hljs-keyword,[data-theme=light] .hljs-meta [data-theme=light] .hljs-keyword,[data-theme=light] .hljs-template-tag,[data-theme=light] .hljs-template-variable,[data-theme=light] .hljs-type,[data-theme=light] .hljs-variable[data-theme=light] .language_{color:#d73a49}[data-theme=light] .hljs-title,[data-theme=light] .hljs-title[data-theme=light] .class_,[data-theme=light] .hljs-title[data-theme=light] .class_[data-theme=light] .inherited__,[data-theme=light] .hljs-title[data-theme=light] .function_{color:#6f42c1}[data-theme=light] .hljs-attr,[data-theme=light] .hljs-attribute,[data-theme=light] .hljs-literal,[data-theme=light] .hljs-meta,[data-theme=light] .hljs-number,[data-theme=light] .hljs-operator,[data-theme=light] .hljs-selector-attr,[data-theme=light] .hljs-selector-class,[data-theme=light] .hljs-selector-id,[data-theme=light] .hljs-variable{color:#005cc5}[data-theme=light] .hljs-meta [data-theme=light] .hljs-string,[data-theme=light] .hljs-regexp,[data-theme=light] .hljs-string{color:#032f62}[data-theme=light] .hljs-built_in,[data-theme=light] .hljs-symbol{color:#e36209}[data-theme=light] .hljs-code,[data-theme=light] .hljs-comment,[data-theme=light] .hljs-formula{color:#6a737d}[data-theme=light] .hljs-name,[data-theme=light] .hljs-quote,[data-theme=light] .hljs-selector-pseudo,[data-theme=light] .hljs-selector-tag{color:#22863a}[data-theme=light] .hljs-subst{color:#24292e}[data-theme=light] .hljs-section{color:#005cc5;font-weight:700}[data-theme=light] .hljs-bullet{color:#735c0f}[data-theme=light] .hljs-emphasis{color:#24292e;font-style:italic}[data-theme=light] .hljs-strong{color:#24292e;font-weight:700}[data-theme=light] .hljs-addition{color:#22863a;background-color:#f0fff4}[data-theme=light] .hljs-deletion{color:#b31d28;background-color:#ffeef0}
</style><pre q:key="xV_0"><code>cargo build --release --target wasm32-unknown-unknown
wasm-bindgen --out-dir ./out/ --target web ./target/wasm32-unknown-unknown/release/game1.wasm</code></pre><!--/qv--><p>The above 2 commands was everything necessary to get a js and wasm bundle. To run it you just import the JS bundle and initialize it. Note that if you initialize it automatically the browser might not have permission to play audio. So if your game has sounds you should initialize from a click event.</p><!--qv q:id=1b q:key=gQCP:XF_10--><pre q:key="xV_0"><code><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;module&quot;</span>&gt;</span><span class="language-javascript">
  <span class="hljs-keyword">import</span> init <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./game1.js&#x27;</span>
  <span class="hljs-title function_">init</span>()
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></code></pre><!--/qv--><p>The only gotcha with this setup is it expects your assets to be in a certain relative structure. If you are using a JS framework it might not be trivial to import and run the files correctly. The way I set it up is that I made a new directory to serve static assets from which contains the following.</p><!--qv q:id=1c q:key=gQCP:XF_11--><pre q:key="xV_0"><code># In /public/play-slimegame directory (statically served files)

index.html # empty page with above JS init snippet and some styling
game1.js
game1.wasm
assets/player.png
assets/font.ttf
...</code></pre><!--/qv--><p>Currently it just appends a canvas to the body element. I'll do some research on how to nicely embed it into an existing canvas in a more controlled fashion.</p><h2>Conclusion</h2><p>I was quite surprised how the well game turned out taking into consideration this is my first game project. It's not really a complete fun game right now, but with a little bit of more work I could see it being playable.</p><p>I struggled quite a lot with developing this because most of my search results only found the official docs rather than a discussion about the specific problem I was trying to solve. The documentation of Bevy and Rapier is a little bit hard to understand for a new game developer. Their examples were invaluable, but I wish they had more complex ones.</p><p>Thankfully I stumbled on <a target="_blank" rel="noopener" href="https://bevy-cheatbook.github.io/">Unofficial Bevy Cheat Book</a>, which is an amazing resource. It helped me learn Bevy in a more pragmatic way rather than with only trial and error. My only mistake was that I didn't read it earlier. I couldn't have finished the game without it.</p><p>My biggest issue was collision detection. It seems like Rapier is more designed for hands off physics simulation. Making your own logic on collisions seems quite unintuitive. The docs explain it only from Rapier API point of view, but do not actually show how to practically do anything with it.</p><p>The way Bevy works is you query for entity components in the system parameters. These are super nice type safe ways to access data in the ECS. But what do you do when you only have an entity ID as you'd have from a collision event? I wanted to write a query in the system body, rather than the parameter. The solution was quite obvious in hindsight. Here is an example of it, not from Rapier, but from my custom event.</p><!--qv q:id=1d q:key=gQCP:XF_12--><pre q:key="xV_0"><code><span class="hljs-keyword">pub</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">handle_damage_event</span>(
  <span class="hljs-keyword">mut</span> commands: Commands,
  <span class="hljs-keyword">mut</span> damage_events: EventReader&lt;DamageEvent&gt;,
  <span class="hljs-keyword">mut</span> enemies: Query&lt;&amp;<span class="hljs-keyword">mut</span> Health, With&lt;Enemy&gt;&gt;,
) {
  <span class="hljs-keyword">for</span> <span class="hljs-variable">damage_event</span> <span class="hljs-keyword">in</span> damage_events.<span class="hljs-title function_ invoke__">iter</span>() {
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> <span class="hljs-variable">Ok</span>(<span class="hljs-keyword">mut</span> health) = enemies.<span class="hljs-title function_ invoke__">get_mut</span>(damage_event.entity) {
      health.current_health -= damage_event.damage;
      <span class="hljs-keyword">if</span> health.current_health &lt;= <span class="hljs-number">0.0</span> {
        commands.<span class="hljs-title function_ invoke__">entity</span>(damage_event.entity).<span class="hljs-title function_ invoke__">despawn</span>();
      }
    }
  }
}</code></pre><!--/qv--><p>The <span class="inline-code">DamageEvent</span> gives us an entity ID and an f32 for the amount of damage the entity should take. We query all the enemies, but the event will only <span class="inline-code">.get_mut</span> the one it's interested in. After I figured this out I started making a lot more progress and was able to actually add the features I wanted.</p><h2>Update: Day 8, 9 &amp; 10</h2><!--qv q:sstyle=⭐️pubbq6-0 q:id=1e q:key=BiHb:XF_13--><div style="padding-bottom:45.416666666666664%" class="⭐️pubbq6-0 image-container" q:key="Qj_0" q:id="1f"><div style="background:#b3997f" class="⭐️pubbq6-0 image-placeholder" q:id="1g"></div><img alt src="/images/slimegame/slimegame_upgrades.png" loading="lazy" class="⭐️pubbq6-0" q:id="1h"></div><!--/qv--><p>Seems like monday was a public holiday as well, so I decided to continue developing over the following long weekend.</p><ul><li>Reorganized code into modules</li><li>Created 3 levels (including a bossfight)</li><li>Added weapon and player upgrades</li><li>Added autosave</li></ul><!--qv q:sstyle=⭐️20zyf1-0 q:id=1i q:key=yx4i:XF_14--><div style="padding-bottom:56.25%" class="⭐️20zyf1-0 video-container" q:key="Aa_0" q:id="1j"><div style="background:#b2987f" class="⭐️20zyf1-0 video-placeholder" q:id="1k"></div><video src="/images/slimegame/day_10_boss.mp4" controls="" class="⭐️20zyf1-0" q:id="1l"></video></div><!--/qv--><p>It's really amazing how easily you can refactor rust code!</p><p>The source code is in my <a rel="noopener" href="https://github.com/jonniek/slimegame">github</a> if you are interested.</p><h2 id="play">Want to give the game a try?</h2><p>Here is the controls</p><ul><li><strong>arrow keys</strong> - player 1 movement</li><li><strong>space</strong> - player 1 attack</li><li><strong>wasd</strong> - player 2 movement</li><li><strong>q</strong> - player 2 attack</li></ul><p id="play"><a href="/play-slimegame" target="_blank">Play the game here!</a> (There is no loading indicator, give it a second)</p></article><!--/qv--><!--/qv--></div><!--/qv--><script type="placeholder" hidden q:id="1m" on-document:qinit="q-d56fd61c.js#s_KnNE9eL0qfc"></script><!--/qv--><!--qv q:key=35_2--><script q:key="1Z_0">((s,a,i,r)=>{i=(e,t)=>{t=document.querySelector("[q\\:base]"),t&&a.active&&a.active.postMessage({type:"qprefetch",base:t.getAttribute("q:base"),...e})},document.addEventListener("qprefetch",e=>{const t=e.detail;a?i(t):t.bundles&&s.push(...t.bundles)}),navigator.serviceWorker.register("/service-worker.js").then(e=>{r=()=>{a=e,i({bundles:s})},e.installing?e.installing.addEventListener("statechange",t=>{t.target.state=="activated"&&r()}):e.active&&r()}).catch(e=>console.error(e))})([])</script><!--/qv--></body><!--/qv--><!--/qv--><!--/qv--><script type="qwik/json">{"refs":{"4":"1","8":"1"},"ctx":{},"objs":["light","\u00120"],"subs":[]}</script><script type="module">document.dispatchEvent(new CustomEvent("qprefetch",{detail:{"bundles":["q-54615ccf.js","q-94ebc968.js","q-0a1e4242.js","q-57b76970.js","q-d56fd61c.js"]}}))</script><script type="module">const u=["/build/q-54615ccf.js","/build/q-94ebc968.js","/build/q-0a1e4242.js","/build/q-57b76970.js","/build/q-d56fd61c.js"];const w=new Worker(URL.createObjectURL(new Blob(['onmessage=(e)=>{Promise.all(e.data.map(u=>fetch(u))).finally(()=>{setTimeout(postMessage({}),9999)})}'],{type:"text/javascript"})));w.postMessage(u.map(u=>new URL(u,origin)+''));w.onmessage=()=>{w.terminate()};</script><script id="qwikloader">((e,t)=>{const n="__q_context__",o=window,i=new Set,s=t=>e.querySelectorAll(t),r=(e,t,n=t.type)=>{s("[on"+e+"\\:"+n+"]").forEach((o=>f(o,e,t,n)))},a=(e,t)=>e.getAttribute(t),l=t=>{if(void 0===t._qwikjson_){let n=(t===e.documentElement?e.body:t).lastElementChild;for(;n;){if("SCRIPT"===n.tagName&&"qwik/json"===a(n,"type")){t._qwikjson_=JSON.parse(n.textContent.replace(/\\x3C(\/?script)/g,"<$1"));break}n=n.previousElementSibling}}},c=(e,t)=>new CustomEvent(e,{detail:t}),f=async(t,o,i,s=i.type)=>{const r="on"+o+":"+s;t.hasAttribute("preventdefault:"+s)&&i.preventDefault();const c=t._qc_,f=null==c?void 0:c.li.filter((e=>e[0]===r));if(f&&f.length>0){for(const e of f)await e[1].getFn([t,i],(()=>t.isConnected))(i,t);return}const d=a(t,r);if(d){const o=t.closest("[q\\:container]"),s=new URL(a(o,"q:base"),e.baseURI);for(const r of d.split("\n")){const a=new URL(r,s),c=a.hash.replace(/^#?([^?[|]*).*$/,"$1")||"default",f=performance.now(),d=import(a.href.split("#")[0]);l(o);const p=b(await d,c),w=e[n];if(t.isConnected)try{e[n]=[t,i,a],u("qsymbol",{symbol:c,element:t,reqTime:f}),await p(i,t)}finally{e[n]=w}}}},u=(t,n)=>{e.dispatchEvent(c(t,n))},b=(e,t)=>{if(t in e)return e[t];for(const n of Object.values(e))if("object"==typeof n&&n&&t in n)return n[t]},d=e=>e.replace(/([A-Z])/g,(e=>"-"+e.toLowerCase())),p=async e=>{let t=d(e.type),n=e.target;for(r("-document",e,t);n&&n.getAttribute;)await f(n,"",e,t),n=e.bubbles&&!0!==e.cancelBubble?n.parentElement:null},w=e=>{r("-window",e,d(e.type))},q=()=>{var n;const r=e.readyState;if(!t&&("interactive"==r||"complete"==r)&&(t=1,u("qinit"),(null!=(n=o.requestIdleCallback)?n:o.setTimeout).bind(o)((()=>u("qidle"))),i.has("qvisible"))){const e=s("[on\\:qvisible]"),t=new IntersectionObserver((e=>{for(const n of e)n.isIntersecting&&(t.unobserve(n.target),f(n.target,"",c("qvisible",n)))}));e.forEach((e=>t.observe(e)))}},v=(e,t,n,o=!1)=>e.addEventListener(t,n,{capture:o}),y=t=>{for(const n of t)i.has(n)||(v(e,n,p,!0),v(o,n,w),i.add(n))};if(!e.qR){const t=o.qwikevents;Array.isArray(t)&&y(t),o.qwikevents={push:(...e)=>y(e)},v(e,"readystatechange",q),q()}})(document);</script><script>window.qwikevents.push("load", "click", "qinit")</script></html>