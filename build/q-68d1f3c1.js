import{I as i}from"./q-82451e12.js";import{S as a}from"./q-05f9ae1c.js";import{p as o,z as s,_ as u,A as e,N as t,M as l}from"./q-94ebc968.js";import{f as r}from"./q-57b76970.js";import{title as h}from"./q-0cc12d3e.js";const n=o(s(()=>u(()=>import("./q-b943942a.js"),["build/q-b943942a.js","build/q-94ebc968.js"]),"s_yx4ivJ1ZsH8")),y=()=>e("article",null,null,[e("div",null,null,e("a",null,{href:"/"},"Home",3,null),3,null),e("h1",null,null,h,3,null),e("p",null,null,r(new Date("2023-01-04")),1,null),t(i,{height:522,width:1386,placeholder:"#b3997f",src:"/images/slimegame/slimegame_gameplay.png",[l]:{height:l,width:l,placeholder:l,src:l}},3,"XF_0"),e("p",null,null,e("a",null,{href:"#play"},e("small",null,null,"TLDR: if you just want to play the game click here",3,null),3,null),3,null),e("h2",null,null,"Let's make a game. But why?",3,null),e("p",null,null,"I'm on work assignment in Japan and they have quite many public holidays around new years. Most places are closed during this time so instead of traveling around I decided to challenge myself with a solo game jam. I've always been somewhat interested in game development, but never quite had the time or motivation to properly learn it. I decided to make a game in seven days from scratch. As a software developer with no game development experience I wasn't quite sure what I was getting into.",3,null),e("h2",null,null,"Day 1",3,null),e("p",null,null,"The first day was mostly spent on deciding which game engine to use. After some comparisons and research I decided to give Bevy a try. Bevy is an ECS based game engine for Rust. I really like the premise of the engine even though it's quite barebones.",3,null),e("p",null,null,"The first day I only implemented some basic player movement.",3,null),t(n,{placeholder:"#787878",height:720,width:1280,src:"/images/slimegame/day_01_input.mp4",controls:!0,[l]:{placeholder:l,height:l,width:l,src:l,controls:l}},3,"XF_1"),e("h2",null,null,"Day 2",3,null),e("p",null,null,"I started experimenting with physics. I chose to use Rapier as a physics engine as it seemed the most popular. It was really confusing but I got something working after a lot of trial and error.",3,null),t(n,{placeholder:"#787878",height:720,width:1280,src:"/images/slimegame/day_02_physics.mp4",controls:!0,[l]:{placeholder:l,height:l,width:l,src:l,controls:l}},3,"XF_2"),e("p",null,null,["What you are seeing above is not actually fully Rapier physics because I was doing it wrong. I was manually reversing and damping the velocity on collision. This kind of broke down once you got into close contact like sliding. What later helped me understand and setup Rapier correctly was"," ",e("a",null,{rel:"noopener",target:"_blank",href:"https://www.youtube.com/watch?v=fFm1IxuPQxA"},"this presentation",3,null)," ","by Nathan Stocks. It simply setup some components for the entities that handle all the collisions and dampening automatically. I wish the Rapier Bevy plugin getting started documentation was a bit more like this video."],3,null),e("p",null,null,"On the second day I also did some Tilemap experimentation with LDtk. With a plugin I got LDtk levels imported to the game quite easily. However, after importing it I kind of got stuck not being able to continue development. I think this was due to a lack of understanding of how the plugin and LDtk worked. I decided to ditch the LDtk approach to make progress in the actual game.",3,null),t(n,{placeholder:"#787878",height:720,width:1280,src:"/images/slimegame/day_02_map.mp4",controls:!0,[l]:{placeholder:l,height:l,width:l,src:l,controls:l}},3,"XF_3"),e("h2",null,null,"Day 3",3,null),e("p",null,null,"On the third day I created a basic game loop. The purpose of the game is to eat all red slimes. When you eat a slime you grow in size, which will help you finish eating them all.",3,null),t(n,{placeholder:"#787878",height:720,width:1280,src:"/images/slimegame/day_03_game.mp4",controls:!0,[l]:{placeholder:l,height:l,width:l,src:l,controls:l}},3,"XF_4"),e("h2",null,null,"Day 4",3,null),e("p",null,null,`Now that there was a "complete" game, I decided to add a menu and game over screen. It's quite verbose to declare plugins for the game states. However, the UI components themselves were quite nice with CSS flexbox like styling. I wanted to add some settings menu, but I didn't really have any settings to change. So in order to save more time to making the game better I left it out of scope.`,3,null),t(n,{placeholder:"#787878",height:720,width:1280,src:"/images/slimegame/day_04_menu.mp4",controls:!0,[l]:{placeholder:l,height:l,width:l,src:l,controls:l}},3,"XF_5"),e("h2",null,null,"Day 5",3,null),e("p",null,null,"Scaling the player made it look very bad and pixelated so I changed the gameplay a bit. Instead of running into red slimes, from now on one should avoid them. I added some weapons to help deal with the evergrowing slime population.",3,null),t(n,{placeholder:"#787878",height:720,width:1280,src:"/images/slimegame/day_05_mechanics.mp4",controls:!0,[l]:{placeholder:l,height:l,width:l,src:l,controls:l}},3,"XF_6"),e("h2",null,null,"Day 6",3,null),e("p",null,null,"Adding more features.",3,null),e("ul",null,null,[e("li",null,null,"Local coop",3,null),e("li",null,null,"Health for enemies",3,null),e("li",null,null,"New weapon for player 2",3,null),e("li",null,null,"Stronger enemy slimes that move towards player",3,null),e("li",null,null,"I couldn't figure out how to make an image as an infinite tiled background. So I just added a colored background with some lines drawn with Lyon.",3,null)],3,null),t(n,{placeholder:"#b2987f",height:720,width:1280,src:"/images/slimegame/day_06_polish.mp4",controls:!0,[l]:{placeholder:l,height:l,width:l,src:l,controls:l}},3,"XF_7"),e("h2",null,null,"Day 7",3,null),e("p",null,null,"Final polish.",3,null),e("ul",null,null,[e("li",null,null,"Update all assets to be original. Instead of zooming camera I just made assets bigger.",3,null),e("li",null,null,"Red zone that kills player. I wanted to make it a circle but I didn't have time to figure out how to punch a hole in a square in Lyon.",3,null),e("li",null,null,"Indicator when weapon is ready to use. This was surprisingly easy with child entities and sprite visibility toggling.",3,null),e("li",null,null,"Remove redundant screens. The game over screen was almost the same as start screen and the splash screen just looked like some loading issue.",3,null)],3,null),t(n,{placeholder:"#b2987f",height:720,width:1280,src:"/images/slimegame/day_07_polish.mp4",controls:!0,[l]:{placeholder:l,height:l,width:l,src:l,controls:l}},3,"XF_8"),e("h2",null,null,"Building to web assembly",3,null),e("p",null,null,"To my surprise I did not need to change anything in my source code in order to build the game in wasm. Adding it to my website was trivial. Really nice experience overall.",3,null),t(a,{language:"bash",text:`cargo build --release --target wasm32-unknown-unknown
wasm-bindgen --out-dir ./out/ --target web ./target/wasm32-unknown-unknown/release/game1.wasm`,[l]:{language:l,text:l}},3,"XF_9"),e("p",null,null,"The above 2 commands was everything necessary to get a js and wasm bundle. To run it you just import the JS bundle and initialize it. Note that if you initialize it automatically the browser might not have permission to play audio. So if your game has sounds you should initialize from a click event.",3,null),t(a,{language:"html",text:`<script type="module">
  import init from './game1.js'
  init()
<\/script>`,[l]:{language:l,text:l}},3,"XF_10"),e("p",null,null,"The only gotcha with this setup is it expects your assets to be in a certain relative structure. If you are using a JS framework it might not be trivial to import and run the files correctly. The way I set it up is that I made a new directory to serve static assets from which contains the following.",3,null),t(a,{language:"text",text:`# In /public/play-slimegame directory (statically served files)

index.html # empty page with above JS init snippet and some styling
game1.js
game1.wasm
assets/player.png
assets/font.ttf
...`,[l]:{language:l,text:l}},3,"XF_11"),e("p",null,null,"Currently it just appends a canvas to the body element. I'll do some research on how to nicely embed it into an existing canvas in a more controlled fashion.",3,null),e("h2",null,null,"Conclusion",3,null),e("p",null,null,"I was quite surprised how the well game turned out taking into consideration this is my first game project. It's not really a complete fun game right now, but with a little bit of more work I could see it being playable.",3,null),e("p",null,null,"I struggled quite a lot with developing this because most of my search results only found the official docs rather than a discussion about the specific problem I was trying to solve. The documentation of Bevy and Rapier is a little bit hard to understand for a new game developer. Their examples were invaluable, but I wish they had more complex ones.",3,null),e("p",null,null,["Thankfully I stumbled on"," ",e("a",null,{target:"_blank",rel:"noopener",href:"https://bevy-cheatbook.github.io/"},"Unofficial Bevy Cheat Book",3,null),", which is an amazing resource. It helped me learn Bevy in a more pragmatic way rather than with only trial and error. My only mistake was that I didn't read it earlier. I couldn't have finished the game without it."],3,null),e("p",null,null,"My biggest issue was collision detection. It seems like Rapier is more designed for hands off physics simulation. Making your own logic on collisions seems quite unintuitive. The docs explain it only from Rapier API point of view, but do not actually show how to practically do anything with it.",3,null),e("p",null,null,"The way Bevy works is you query for entity components in the system parameters. These are super nice type safe ways to access data in the ECS. But what do you do when you only have an entity ID as you'd have from a collision event? I wanted to write a query in the system body, rather than the parameter. The solution was quite obvious in hindsight. Here is an example of it, not from Rapier, but from my custom event.",3,null),t(a,{language:"rust",text:`pub fn handle_damage_event(
  mut commands: Commands,
  mut damage_events: EventReader<DamageEvent>,
  mut enemies: Query<&mut Health, With<Enemy>>,
) {
  for damage_event in damage_events.iter() {
    if let Ok(mut health) = enemies.get_mut(damage_event.entity) {
      health.current_health -= damage_event.damage;
      if health.current_health <= 0.0 {
        commands.entity(damage_event.entity).despawn();
      }
    }
  }
}`,[l]:{language:l,text:l}},3,"XF_12"),e("p",null,null,["The ",e("span",null,{class:"inline-code"},"DamageEvent",3,null)," gives us an entity ID and an f32 for the amount of damage the entity should take. We query all the enemies, but the event will only"," ",e("span",null,{class:"inline-code"},".get_mut",3,null)," the one it's interested in. After I figured this out I started making a lot more progress and was able to actually add the features I wanted."],3,null),e("h2",null,null,"Update: Day 8, 9 & 10",3,null),t(i,{height:545,lazy:!0,width:1200,placeholder:"#b3997f",src:"/images/slimegame/slimegame_upgrades.png",[l]:{height:l,lazy:l,width:l,placeholder:l,src:l}},3,"XF_13"),e("p",null,null,"Seems like monday was a public holiday as well, so I decided to continue developing over the following long weekend.",3,null),e("ul",null,null,[e("li",null,null,"Reorganized code into modules",3,null),e("li",null,null,"Created 3 levels (including a bossfight)",3,null),e("li",null,null,"Added weapon and player upgrades",3,null),e("li",null,null,"Added autosave",3,null)],3,null),t(n,{placeholder:"#b2987f",height:720,width:1280,src:"/images/slimegame/day_10_boss.mp4",controls:!0,[l]:{placeholder:l,height:l,width:l,src:l,controls:l}},3,"XF_14"),e("p",null,null,"It's really amazing how easily you can refactor rust code!",3,null),e("p",null,null,["The source code is in my"," ",e("a",null,{rel:"noopener",href:"https://github.com/jonniek/slimegame"},"github",3,null)," ","if you are interested."],3,null),e("h2",null,{id:"play"},"Want to give the game a try?",3,null),e("p",null,null,"Here is the controls",3,null),e("ul",null,null,[e("li",null,null,[e("strong",null,null,"arrow keys",3,null)," - player 1 movement"],3,null),e("li",null,null,[e("strong",null,null,"space",3,null)," - player 1 attack"],3,null),e("li",null,null,[e("strong",null,null,"wasd",3,null)," - player 2 movement"],3,null),e("li",null,null,[e("strong",null,null,"q",3,null)," - player 2 attack"],3,null)],3,null),e("p",null,{id:"play"},[e("a",null,{href:"/play-slimegame",target:"_blank"},"Play the game here!",3,null)," ","(There is no loading indicator, give it a second)"],3,null)],1,"XF_15");export{y as s_1DsTj64uULI};
